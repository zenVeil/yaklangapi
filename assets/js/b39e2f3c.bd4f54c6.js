"use strict";(self.webpackChunkyaklangapi=self.webpackChunkyaklangapi||[]).push([[318],{3308:(e,a,r)=>{r.r(a),r.d(a,{assets:()=>t,contentTitle:()=>c,default:()=>o,frontMatter:()=>s,metadata:()=>n,toc:()=>u});const n=JSON.parse('{"id":"api/suricata","title":"suricata","description":"\u63cf\u8ff0\u4fe1\u606f","source":"@site/docs/api/suricata.md","sourceDirName":"api","slug":"/api/suricata","permalink":"/docs/api/suricata","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":79,"frontMatter":{"sidebar_position":79,"sidebar_label":"suricata","slug":"/api/suricata","tags":[],"title":"suricata","description":"\u63cf\u8ff0\u4fe1\u606f"},"sidebar":"apiSidebar","previous":{"title":"str","permalink":"/docs/api/str"}}');var i=r(4848),l=r(8453);const s={sidebar_position:79,sidebar_label:"suricata",slug:"/api/suricata",tags:[],title:"suricata",description:"\u63cf\u8ff0\u4fe1\u606f"},c="\u51fd\u6570\u5b9a\u4e49",t={},u=[{value:"LoadSuricataToDatabase",id:"loadsuricatatodatabase",level:2},{value:"NewSuricataMatcher",id:"newsuricatamatcher",level:2},{value:"NewSuricataMatcherGroup",id:"newsuricatamatchergroup",level:2},{value:"ParseSuricata",id:"parsesuricata",level:2},{value:"TrafficGenerator",id:"trafficgenerator",level:2},{value:"YieldRules",id:"yieldrules",level:2},{value:"YieldRulesByKeyword",id:"yieldrulesbykeyword",level:2},{value:"YieldSuricataRulesByKeywords",id:"yieldsuricatarulesbykeywords",level:2},{value:"groupCallback",id:"groupcallback",level:2}];function d(e){const a={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.header,{children:(0,i.jsx)(a.h1,{id:"\u51fd\u6570\u5b9a\u4e49",children:"\u51fd\u6570\u5b9a\u4e49"})}),"\n",(0,i.jsx)(a.h2,{id:"loadsuricatatodatabase",children:"LoadSuricataToDatabase"}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsx)(a.li,{children:"\u63cf\u8ff0: \u5c06\u539f\u59cb Suricata \u89c4\u5219\u5b57\u7b26\u4e32\u52a0\u8f7d\u5230\u6570\u636e\u5e93\u4e2d\uff0c\u4fbf\u4e8e\u540e\u7eed\u89c4\u5219\u7ba1\u7406\u548c\u5339\u914d\u64cd\u4f5c\u3002"}),"\n"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-go",children:'rawRules := `alert http any any -> any any (msg:"Test Rule"; content:"example"; sid:1;)`\nsuricata.LoadSuricataToDatabase(rawRules)\n'})}),"\n",(0,i.jsx)(a.h2,{id:"newsuricatamatcher",children:"NewSuricataMatcher"}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsx)(a.li,{children:"\u63cf\u8ff0: \u57fa\u4e8e\u6307\u5b9a\u7684 Suricata \u89c4\u5219\u5bf9\u8c61\u521b\u5efa\u4e00\u4e2a\u5339\u914d\u5668\uff0c\u7528\u4e8e\u5bf9\u7f51\u7edc\u6570\u636e\u5305\u8fdb\u884c\u89c4\u5219\u5339\u914d"}),"\n"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-go",children:'rules, _ := suricata.ParseSuricata(`alert tcp any any -> any any (msg:"match test"; content:"abc"; sid:2;)`)\nmatcher := suricata.NewSuricataMatcher(rules[0])\n'})}),"\n",(0,i.jsx)(a.h2,{id:"newsuricatamatchergroup",children:"NewSuricataMatcherGroup"}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsx)(a.li,{children:"\u63cf\u8ff0: \u521b\u5efa\u4e00\u4e2a\u89c4\u5219\u5339\u914d\u5668\u7ec4\uff0c\u652f\u6301\u901a\u8fc7\u53ef\u9009\u53c2\u6570\u914d\u7f6e\u5339\u914d\u884c\u4e3a\uff0c\u4f8b\u5982\u6dfb\u52a0\u56de\u8c03\u51fd\u6570\u7b49\u3002"}),"\n"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-go",children:'group := suricata.NewSuricataMatcherGroup(\n    suricata.groupCallback(func(pkt, rule) {\n        println("Matched:", rule.SID)\n    })\n)\n'})}),"\n",(0,i.jsx)(a.h2,{id:"parsesuricata",children:"ParseSuricata"}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsx)(a.li,{children:"\u63cf\u8ff0: \u89e3\u6790 Suricata \u89c4\u5219\u5b57\u7b26\u4e32\uff0c\u8fd4\u56de\u89c4\u5219\u5bf9\u8c61\u5217\u8868\u3002\u53ef\u9009\u7684\u73af\u5883\u53d8\u91cf\u53c2\u6570\u7528\u4e8e\u5904\u7406\u89c4\u5219\u4e2d\u7684\u53d8\u91cf\u66ff\u6362\u3002"}),"\n"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-go",children:'rules, err := suricata.ParseSuricata(`\n    alert tcp any any -> any any (msg:"Test1"; content:"aaa"; sid:1001;)\n    alert udp any any -> any any (msg:"Test2"; content:"bbb"; sid:1002;)\n`)\n'})}),"\n",(0,i.jsx)(a.h2,{id:"trafficgenerator",children:"TrafficGenerator"}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsx)(a.li,{children:"\u63cf\u8ff0: \u521b\u5efa\u4e00\u4e2a\u6d41\u91cf\u751f\u6210\u5668\u5bf9\u8c61\uff0c\u7528\u4e8e\u6a21\u62df\u7f51\u7edc\u6d41\u91cf\uff0c\u6d4b\u8bd5\u89c4\u5219\u7684\u5339\u914d\u6548\u679c\u3002"}),"\n"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-go",children:'gen := suricata.TrafficGenerator()\ngen.TCP("192.168.0.1", "80").Payload("abc").Send()\n'})}),"\n",(0,i.jsx)(a.h2,{id:"yieldrules",children:"YieldRules"}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsx)(a.li,{children:"\u63cf\u8ff0: \u8fd4\u56de\u4e00\u4e2a\u901a\u9053\uff0c\u9010\u4e2a\u8f93\u51fa\u5df2\u52a0\u8f7d\u7684\u89c4\u5219\u5b58\u50a8\u5bf9\u8c61\uff0c\u9002\u7528\u4e8e\u89c4\u5219\u904d\u5386\u548c\u5904\u7406\u3002"}),"\n"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-go",children:'for r := range suricata.YieldRules() {\n    println("Rule:", r.Rule.SID)\n}\n'})}),"\n",(0,i.jsx)(a.h2,{id:"yieldrulesbykeyword",children:"YieldRulesByKeyword"}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsx)(a.li,{children:"\u63cf\u8ff0: \u6839\u636e\u6307\u5b9a\u7684\u5173\u952e\u5b57\u548c\u534f\u8bae\u8fc7\u6ee4\u89c4\u5219\uff0c\u8fd4\u56de\u5339\u914d\u7684\u89c4\u5219\u5b58\u50a8\u5bf9\u8c61\u901a\u9053\u3002"}),"\n"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-go",children:'for r := range suricata.YieldRulesByKeyword("example", "http") {\n    println("Matched rule SID:", r.Rule.SID)\n}\n'})}),"\n",(0,i.jsx)(a.h2,{id:"yieldsuricatarulesbykeywords",children:"YieldSuricataRulesByKeywords"}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsx)(a.li,{children:"\u63cf\u8ff0: \u529f\u80fd\u7c7b\u4f3c\u4e8e YieldRulesByKeyword\uff0c\u7528\u4e8e\u6839\u636e\u5173\u952e\u5b57\u548c\u534f\u8bae\u7b5b\u9009 Suricata \u89c4\u5219\u3002"}),"\n"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-go",children:'for r := range suricata.YieldSuricataRulesByKeywords("test", "tcp") {\n    println("Filtered SID:", r.Rule.SID)\n}\n'})}),"\n",(0,i.jsx)(a.h2,{id:"groupcallback",children:"groupCallback"}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsx)(a.li,{children:"\u63cf\u8ff0: \u5b9a\u4e49\u4e00\u4e2a\u56de\u8c03\u51fd\u6570\u9009\u9879\uff0c\u7528\u4e8e\u5728\u89c4\u5219\u5339\u914d\u65f6\u6267\u884c\u7279\u5b9a\u64cd\u4f5c\uff0c\u5982\u65e5\u5fd7\u8bb0\u5f55\u6216\u81ea\u5b9a\u4e49\u5904\u7406\u3002"}),"\n"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-go",children:'cb := suricata.groupCallback(func(pkt, rule) {\n    println("Detected:", rule.Msg)\n})\ngroup := suricata.NewSuricataMatcherGroup(cb)\n'})})]})}function o(e={}){const{wrapper:a}={...(0,l.R)(),...e.components};return a?(0,i.jsx)(a,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,a,r)=>{r.d(a,{R:()=>s,x:()=>c});var n=r(6540);const i={},l=n.createContext(i);function s(e){const a=n.useContext(l);return n.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function c(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),n.createElement(l.Provider,{value:a},e.children)}}}]);